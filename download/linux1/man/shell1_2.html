<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Transitional//EN">
<HTML>
<HEAD>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <meta name="Author" content="NPO KLOTO">
   <meta name="Generator" content="Far Editor">
   <meta name="Description" content="Unix">
   <meta name="Keywords" content="unix, shell">
   <title> Интерпретатор командного языка shell. 2</title>
<!--                                                                   -->
</head>

<body >
<p>
<table cellpadding=10>
<tr><td><a href=mind.html>Список команд</a></td></tr>
</table>
<table cellpadding=10>
<tr><td><a href=shell1_1.html>Назад</a></td><td><a href=shindex.html>Оглавление</a></td><td><a href=shell1_3.html>Вперед</a></td></tr>
</table>
</p>
<hr>
<a name=2></a>
<h3 align=center>2. Синтаксис языка shell </h3>
<a name=2_1></a>
<h4> 2.1. Комментарии</h4>
<p align=justify>    Строки, начинающиеся с #, трактуются как комментарии.
<a name=2_2></a>
<h4> 2.2. Подстановка результатов выполнения команд</h4>
<p align=justify>Выражения можно заключать в обратные кавычки (`).    Такие выражения вычисляются в месте использования.  Они  могут  быть, например, частью строк. Пример. Пусть  параметром  макрокоманды является имя файла с расширением .for. Требуется удалить одноименный файл с расширением .err.
<pre>
        name=`ena -n $1`
        rm -f ${name}.err
</pre>
Значение, полученное в результате выполнения команды
<pre>
ena -n $1
</pre>
присваивается переменной name. Фигурные скобки использованы для выделения аргумента операции перехода от имени к значению.  Без них .err приклеилась бы к имени.
<a name=2_3></a>
<h4> 2.3. Переменные и подстановка их значений</h4>
<p align=justify>Все переменные в языке shell - текстовые. Их имена  должны начинаться с буквы и состоять из латинских букв, цифр  и  знака подчеркивания (_). Чтобы воспользоваться  значением  переменной, надо перед ней поставить символ $. Использование значения переменной называется подстановкой.
<p align=justify>     Различается два класса переменных: позиционные и с именем. Позиционные переменные - это  аргументы  командных  файлов,  их именами служат цифры: $0 - имя команды, $1 - первый аргумент  и т.д. Значения позиционным переменным могут быть присвоены и командой set (см.  Специальные  команды).  Пример.  После  вызова программы на shellе, хранящейся в файле ficofl:
<pre>
        ficofl -d / \*.for
</pre>
значением $0 будет ficofl, $1 - -d, $2 - /, $3 - *.for,  значения остальных позиционных переменных  будут  пустыми  строками. Заметим, что если бы символ * при вызове ficofl не был  экранирован, в качестве аргументов передались бы имена всех  фортранных файлов текущей директории.
<p align=justify>Еще две переменные хранят командную строку за  исключением имени команды: $@ эквивалентно $1 $2 ..., а $* - "$1 $2 ...". Начальные значения переменным с именем могут быть установлены следующим образом:
<pre>
        &lt;имя>=&lt;значение> [ &lt;имя>=&lt;значение> ] ...
</pre>
<p align=justify>Не может быть одновременно функции (см.  <a href=shell1_3.html>Управляющие  конструкции</a>) и переменной с одинаковыми именами. Для подстановки значений переменных возможны также следующие конструкции:
<pre>
        ${&lt;переменная>}
</pre>
<p align=justify>если значение &lt;переменной> определено,  то  оно  подставляется. Скобки применяются лишь если за  &lt;переменной>  следует  символ, который без скобок приклеится к имени.
<pre>
        ${&lt;переменная>:-&lt;слово>}
</pre>
<p align=justify>если &lt;переменная> определена и не является пустой  строкой,  то подставляется ее значение; иначе подставляется &lt;слово>.
<pre>
        ${&lt;переменная>:=&lt;слово>}
</pre>
<p align=justify>если &lt;переменная> не определена или является пустой строкой, ей присваивается значение &lt;слово>; после  этого  подставляется  ее значение.
<pre>
        ${&lt;переменная>:?&lt;слово>}
</pre>
<p align=justify>если &lt;переменная> определена и не является пустой  строкой,  то подставляется ее значение; иначе на стандартный вывод выводится &lt;слово> и выполнение shellа завершается. Если &lt;слово>  опущено, то выдается сообщение "parameter null or not set".
<pre>
        ${&lt;переменная>:+&lt;слово>}
</pre>
<p align=justify>если &lt;переменная> определена и не является пустой  строкой,  то подставляется &lt;слово>; иначе подставляется пустая строка.
<p align=justify>Пример: если переменная d не определена или является  пустой строкой, то выполняется команда pwd
<pre>
        echo ${d:-`pwd`}
</pre>
     Следующие переменные автоматически устанавливаются shell'ом:
<p><table border=0 width=100%>
<tr valign=top><td>  #  <td>   количество позиционных параметров (десятичное)
<tr valign=top><td>  - <td>  флаги, указанные при запуске shellа или  командой set
<tr valign=top><td>  ? <td>  десятичное  значение,  возвращенное  предыдущей  синхронно выполненной командой
<tr valign=top><td>  $  <td> номер текущего процесса
<tr valign=top><td>  !  <td>  номер последнего асинхронного процесса
<tr valign=top><td>  @  <td>   эквивалентно $1 $2 $3 ...
<tr valign=top><td>  *  <td>  эквивалентно "$1 $2 $3 ..."
</table>
<p align=justify>Напомним: чтобы получить значения этих переменных,  перед  ними нужно поставить знак $. Пример: выдать номер текущего процесса:
<pre>
        echo $$
</pre>
<a name=2_4></a>
<h4> 2.4. Специальные переменные</h4>
<p align=justify>    Shell'ом используются следующие специальные переменные:
<p><table border=0 width=100%>
<tr valign=top><td>  HOME  <td>  директория, в которую пользователь попадает при         входе в систему или при выполнении  команды  cd  без аргументов
<tr valign=top><td>  PATH  <td>  список полных имен каталогов, в которых  ищется             файл при указании его неполного имени.
<tr valign=top><td> PS1  <td>  основная строка приглашения (по умолчанию $)
<tr valign=top><td>    PS2  <td>   дополнительная строка приглашения (по умолчанию  >); в интерактивном режиме перед вводом команды     shell'ом выводится основная строка  приглашения.<br>   Если нажата клавиша new_line, но для завершения   команды требуется дальнейший ввод, то выводится   дополнительная строка приглашения
<tr valign=top><td>  IFS  <td>  последовательность символов, являющихся  разделителями в командной строке (по  умолчанию  это  &lt;пробел>, &lt;табуляция> и &lt;возврат_каретки>)
</table>
<p><hr>
<table cellpadding=10>
<tr><td><a href=mind.html>Список команд</a></td></tr>
</table>
<table cellpadding=10>
<tr><td><a href=shell1_1.html>Назад</a></td><td><a href=shindex.html>Оглавление</a></td><td><a href=shell1_3.html>Вперед</a></td></tr>
</table>
</p>
</body>
</html>
