<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Transitional//EN">
<HTML>
	<HEAD>
		<TITLE>Лабораторная работа 14.</TITLE>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 		<meta name="Authors" content="Alexander S. Derevjanko, Nataliya V. Maksyuta ">
  		<meta name="Generator" content="KDevelop">
  		<meta name="Description" content="Operating systems, labs ">
   		<meta name="Keywords" content="операционные системы, unix, linux">
		<!--                                                                   -->
		<!-- (C) НТУ "ХПИ". Каф. вычислительной техники и программирования. -->
	</HEAD>
	<body >
		<p>
			<table cellpadding="10">
				<tr>
					<td><a href="l2_5.html">Назад</a></td>
					<td><a href="index.htm">Оглавление</a></td>
					<td><a href="l2_7.html">Вперед</a></td>
				</tr>
			</table>
		</p>
		<hr>
		<table width="90%">
			<tr>
				<td align="center"><img src="logo_6.gif"><samp>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</samp></td>
				<td>
					<h2 align="center">Лабораторная работа N14</h2>
					<h2 align="center">Обмен данными между процессами с помощью общих областей памяти. </h2>
					<p><b>Цель работы</b>: освоение общих областей памяти как способа коммуникаций 
						между процессами.</p>
				</td>
			</tr>
		</table>
		<h3>Общие области памяти</h3>
		<p>
		<p>
		В операционных системах Unix и Linux имеется возможность создавать сегменты 
		памяти, доступные нескольким процессам. При использовании этого средства 
		участки виртуального адресного пространства разных процессов, отображаются на 
		одни и те же адреса реальной памяти.
		<p>
		При работе с общим сегментом памяти один из процессов должен создать сегмент 
		разделяемой (общей) памяти, указав требуемый размер сегмента, и получить его 
		идентификатор. Этот идентификатор затем используется процессом-создателем для 
		выполнения управляющих операций с разделяемой памятью.
		<p>
		Получив идентификатор разделяемого сегмента памяти (создав сегмент или получив 
		его идентификатор от другого процесса), процесс должен "присоединить" сегмент. 
		Операция присоединения возвращает адрес разделяемого сегмента в виртуальном 
		адресном пространстве процесса. Виртуальный адрес одного и того же сегмента 
		может быть разным для разных процессов. Далее процессы ведут чтение и запись 
		данных в сегменте разделяемой памяти, используя для этого те же самые машинные 
		команды, что и при работе с обычной памятью.
		<p>
		Процесс, закончивший работу с сегментом разделяемой памяти должен "отсоединить" 
		его, а по окончании использования сегмента всеми процессами он должен быть 
		уничтожен.
		<p>При одновременной работе процессов с общей областью памяти, возможно, требуется 
			синхронизация их доступа к области. За обеспечение такой синхронизации 
			полностью отвечает программист, который может использовать для этого алгоритмы, 
			исключающие конфликты одновременного доступа или системные средства, например, 
			семафоры.
			<h3>Системные вызовы Unix/Linux</h3>
			В ОС Unix/Linux механизм разделяемых сегментов памяти обеспечивается четырьмя 
			системными вызовами: <samp><a href="./man/_shmget.html">shmget</a></samp>, <samp><a href="./man/_shmctl.html">
					shmctl</a></samp>, <samp><a href="./man/_shmat.html">shmat</a></samp>, <samp>
				<a href="./man/_shmat.html">shmdt</a></samp>
		.
		<p>Системный вызов <samp><a href="./man/_shmget.html">shmget</a></samp>
		создает разделяемый сегмент или возвращает идентификатор уже существующего 
		сегмента. Этот идентификатор используется при дальнейших операциях с сегментом.
		
		<p>Чтобы получить ID нужен ключ, сформировать который можно с помощью <a href=./man/_ftok.html><samp>ftok</samp></a>.
		<p>Системный вызов <samp><a href="./man/_shmctl.html">shmctl</a></samp>
		позволяет выполнять управляющие операции над сегментом: получать информацию о 
		его состоянии, изменять права доступа к нему, уничтожать сегмент.
		
		<p>Системные вызовы <samp><a href="./man/_shmat.html">shmat</a></samp> и <samp><a href="./man/_shmat.html">
					shmdt</a></samp>
		выполняют присоединение и отсоединение сегмента соответственно.
		<p>Разделяемые сегменты памяти в Unix/Linux (как и семафоры) не имеют внешних имен. 
			При получении идентификатора сегмента процесс пользуется числовым ключом. 
			Разработчики несвязанных процессов могут договориться об общем значении ключа, 
			который они будут использовать, но у них нет гарантии в том, что это же 
			значение ключа не будет использовано кем-то еще. Гарантированно уникальный 
			сегмент можно создать с использованием ключа <samp>IPC_PRIVATE</samp>, но такой 
			ключ не может быть внешним. Поэтому сегменты используются, как правило, 
			родственными процессами, которые имеют возможность передавать друг другу их 
			идентификаторы, например, через наследуемые ресурсы или через параметры вызова 
			дочерней программы.
			<table wifth="90%" border="3">
				<tr>
					<td><big><big><big><b>Внимание!</b></big></big></big><br>
						В процессе отладки программы у Вас могут возникать ситуации, когда программа 
						будет аварийно заканчиваться или прерываться Вами прежде, чем она уничтожит 
						созданные ею общие области памяти. Такие области не удаляются в системе 
						автоматически и могут накапливаться в течение многих дней. Накопление таких 
						"забытых" общих областей может привести к тому, что будет исчерпан системный 
						лимит на количество общих областей, и очередной вызов <a href="./man/_shmget.html">shmget</a>
						закончится с ошибкой. Для того, чтобы этого не происходило, регулярно 
						выполняйте процедуру очистки IPC: <samp>/home/metod/<a href="rmipc.html">rmipc</a></samp>. 
						Выполняйте эту процедуру также перед каждым выходом из сеанса.
						<p>Список созданных Вами общих областей Вы можете увидеть, выполнив команду: <samp>ipcs 
								-m</samp>.</p>
					</td>
				</tr>
			</table>


			<h3>Постановка задачи</h3>
			Постановка задачи и индивидуальные задания приведены в 
			<a href=l2_5.html>лабораторной работе №13.</a>
			
		<h3>Отчет по лабораторной работе</h3>
		<p>Отчет по лабораторной работе оформить на украинском языке в соответсвии со следующими пунктами:
			<ul>
				<li>
				Номер работы
				<li>
				Тема работы
				<li>
				Цель работы
				<li>
				Постановка задачи и индивидуальное задание
				<li>
				Тексты программ
				<li>
				Текстовое или графическое описание алгоритмов функционирования программ
				<li>
				Протокол работы программ
				<li>
				Выводы
			</ul>
		<p>Пример выполнения основной части работы №14 приведен <a href="ex2_6.html">здесь</a>.

			<p><hr>
			 <h3 align=center>Справочный материал</h3>
			  <p align=center><a href=./man/mind.html>Избранные системные вызовы Linux/Unix.</a> Краткое описание.
			  <p align=center>Cправочник библиотечных функция языка С: <a href="./man/tcclib1.txt">часть 1</a>, 
			  <a href="./man/tcclib2.txt">часть 2</a> (кодировка кириллица ibm866).
	  
			<hr>
		<p>
			<table cellpadding="10">
				<tr>
					<td><a href="l2_5.html">Назад</a></td>
					<td><a href="index.htm">Оглавление</a></td>
					<td><a href="l2_7.html">Вперед</a></td>
				</tr>
			</table>
	</body>
</HTML>
